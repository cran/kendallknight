<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Basic ‘kendallknight’ usage</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Basic ‘kendallknight’ usage</h1>



<p><em>For the full details about the implementation, please check
Sepulveda MV (2025) Kendallknight: An R package for efficient
implementation of Kendall’s correlation coefficient computation. PLoS
One 20(6): e0326090. <a href="https://doi.org/10.1371/journal.pone.0326090" class="uri">https://doi.org/10.1371/journal.pone.0326090</a></em></p>
<p>The <code>kendallknight</code> package is exclusively focused on the
Kendall’s correlation coefficient and provides additional functions to
test the statistical significance of the computed correlation not
available in other packages, which is particularly useful in econometric
and statistical contexts.</p>
<p>The <code>kendallknight</code> package is available on CRAN and can
be installed using the following command:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># CRAN</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;kendallknight&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co"># GitHub</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;pachadotdev/kendallknight&quot;</span>)</span></code></pre></div>
<p>As an illustrative exercise we can explore the question ‘is there a
relationship between the number of computer science doctorates awarded
in the United States and the total revenue generated by arcades?’
Certainly, this question is about a numerical exercise and not about
causal mechanisms.</p>
<p>The following table obtained from <span class="citation">@vigen2015</span> can be used to illustrate the usage
of the <code>kendallknight</code> package:</p>
<table>
<colgroup>
<col width="5%" />
<col width="53%" />
<col width="40%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">Year</th>
<th align="right">Computer science doctorates awarded in the US</th>
<th align="right">Total revenue generated by arcades</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2000</td>
<td align="right">861</td>
<td align="right">1.196</td>
</tr>
<tr class="even">
<td align="right">2001</td>
<td align="right">830</td>
<td align="right">1.176</td>
</tr>
<tr class="odd">
<td align="right">2002</td>
<td align="right">809</td>
<td align="right">1.269</td>
</tr>
<tr class="even">
<td align="right">2003</td>
<td align="right">867</td>
<td align="right">1.240</td>
</tr>
<tr class="odd">
<td align="right">2004</td>
<td align="right">948</td>
<td align="right">1.307</td>
</tr>
<tr class="even">
<td align="right">2005</td>
<td align="right">1129</td>
<td align="right">1.435</td>
</tr>
<tr class="odd">
<td align="right">2006</td>
<td align="right">1453</td>
<td align="right">1.601</td>
</tr>
<tr class="even">
<td align="right">2007</td>
<td align="right">1656</td>
<td align="right">1.654</td>
</tr>
<tr class="odd">
<td align="right">2008</td>
<td align="right">1787</td>
<td align="right">1.803</td>
</tr>
<tr class="even">
<td align="right">2009</td>
<td align="right">1611</td>
<td align="right">1.734</td>
</tr>
</tbody>
</table>
<p>The <code>kendall_cor()</code> function can be used to compute the
Kendall’s correlation coefficient:</p>
<pre><code>library(kendallknight)

kendall_cor(arcade$doctorates, arcade$revenue)

[1] 0.8222222</code></pre>
<p>The <code>kendall_cor_test()</code> function can be used to test the
null hypothesis that the Kendall’s correlation coefficient is zero:</p>
<pre><code>kendall_cor_test(
  arcade$doctorates,
  arcade$revenue,
  conf.level = 0.8,
  alternative = &quot;greater&quot;
)

        Kendall&#39;s rank correlation tau

data:  arcade$doctorates and arcade$revenue
tau = 0.82222, p-value = 0.0001788
alternative hypothesis: true tau is greater than 0
80 percent confidence interval:
 0.5038182 1.0000000</code></pre>
<p>One important difference with base R implementation is that this
implementation allows to obtain confidence intervals for different
confidence levels (e.g., 95%, 90%, etc).</p>
<p>With the obtained <span class="math inline">\(p\)</span>-value and a
significance level of 80% (the default is 95%), the null hypothesis is
rejected for the two-tailed test (<span class="math inline">\(H_0: \tau
= 0\)</span> versus <span class="math inline">\(H_1: \neq 0\)</span>,
the default option) and the greater than one-tailed test (<span class="math inline">\(H_0: \tau = 0\)</span> versus <span class="math inline">\(H_1: \tau &gt; 0\)</span>) but not for the lower
than one-tailed test (<span class="math inline">\(H_0: \tau = 0\)</span>
versus <span class="math inline">\(H_1: \tau &lt; 0\)</span>). This
suggests the correlation is positive (e.g., more doctorates are
associated with more revenue generated by arcades). In other words,
these three tests tell us that the empirical evidence from this dataset
provides three answers to the research questions:</p>
<ol style="list-style-type: decimal">
<li>Is there any relationship? Yes, more doctorates are associated with
more revenue generated by arcades.</li>
<li>Is there a positive relationship? Yes, more doctorates are
associated with more revenue generated by arcades.</li>
<li>Is there a negative relationship? No, more doctorates are not
associated with less revenue generated by arcades.</li>
</ol>
<p>With base R or <code>Kendall</code>, an equivalent result can be
obtained with the following code:</p>
<pre><code>cor.test(arcade$doctorates, arcade$revenue, method = &quot;kendall&quot;)

        Kendall&#39;s rank correlation tau

data:  arcade$doctorates and arcade$revenue
T = 41, p-value = 0.0003577
alternative hypothesis: true tau is not equal to 0
sample estimates:
      tau 
0.8222222 </code></pre>
<pre><code>Kendall::Kendall(arcade$doctorates, arcade$revenue)

tau = 0.822, 2-sided pvalue =0.0012822</code></pre>
<p>In an Econometric context, the current implementation is particularly
useful to compute the pseudo-<span class="math inline">\(R^2\)</span>
statistic defined as the squared Kendall correlation in the context of
(Quasi) Poisson regression with fixed effects <span class="citation">[@santos;@sepulveda]</span>. A local test reveals how
the pseudo-<span class="math inline">\(R^2\)</span> computation time
drops from fifty to one percent of the time required to compute the
model coefficients by using the <code>fepois()</code> function from the
<code>lfe</code> package <span class="citation">[@gaure]</span> and a
dataset containing fifteen thousand rows <span class="citation">[@yotov]</span>:</p>
<pre><code>library(tradepolicy)
library(lfe)

data8694 &lt;- subset(agtpa_applications, year %in% seq(1986, 1994, 4))

fit &lt;- fepois(
  trade ~ dist + cntg + lang + clny + rta |
    as.factor(paste0(exporter, year)) +
    as.factor(paste0(importer, year)),
  data = data8694
)

psr &lt;- (cor(data8694$trade, fit$fitted.values, method = &quot;kendall&quot;))^2

psr2 &lt;- (kendall_cor(data8694$trade, fit$fitted.values))^2

c(&quot;kendallknight&quot; = psr, &quot;base R&quot; = psr2)

kendallknight        base R 
     0.263012      0.263012 </code></pre>
<p>Comparing the model fitting time versus the correlation computation
time, we can see that the <code>kendallknight</code> package becomes
relevant:</p>
<table>
<thead>
<tr class="header">
<th align="left">Operation</th>
<th align="right">Time</th>
<th align="right">Pseudo <span class="math inline">\(R^2\)</span> /
Model fitting</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Model fitting</td>
<td align="right">3.75s</td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">Pseudo-<span class="math inline">\(R^2\)</span> (base
R)</td>
<td align="right">1.78s</td>
<td align="right">47.58%</td>
</tr>
<tr class="odd">
<td align="left">Pseudo-<span class="math inline">\(R^2\)</span>
(kendallknight)</td>
<td align="right">0.02s</td>
<td align="right">0.51%</td>
</tr>
</tbody>
</table>
<p>For simulated datasets with variables “x” and “y” created with
<code>rnorm()</code> and <code>rpois()</code> we observe a increasingly
time differences as the number of observations increases:</p>
<table>
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="24%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">No. of observations</th>
<th align="center">kendallknight median time (s)</th>
<th align="center">Kendall median time (s)</th>
<th align="center">Base R median time (s)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">10,000</td>
<td align="center">0.013</td>
<td align="center">1.0</td>
<td align="center">4</td>
</tr>
<tr class="even">
<td align="center">20,000</td>
<td align="center">0.026</td>
<td align="center">3.9</td>
<td align="center">16</td>
</tr>
<tr class="odd">
<td align="center">30,000</td>
<td align="center">0.040</td>
<td align="center">8.7</td>
<td align="center">36</td>
</tr>
<tr class="even">
<td align="center">40,000</td>
<td align="center">0.056</td>
<td align="center">15.6</td>
<td align="center">64</td>
</tr>
<tr class="odd">
<td align="center">50,000</td>
<td align="center">0.071</td>
<td align="center">24.2</td>
<td align="center">100</td>
</tr>
<tr class="even">
<td align="center">60,000</td>
<td align="center">0.088</td>
<td align="center">34.8</td>
<td align="center">144</td>
</tr>
<tr class="odd">
<td align="center">70,000</td>
<td align="center">0.104</td>
<td align="center">47.5</td>
<td align="center">196</td>
</tr>
<tr class="even">
<td align="center">80,000</td>
<td align="center">0.123</td>
<td align="center">61.9</td>
<td align="center">256</td>
</tr>
<tr class="odd">
<td align="center">90,000</td>
<td align="center">0.137</td>
<td align="center">78.2</td>
<td align="center">324</td>
</tr>
<tr class="even">
<td align="center">100,000</td>
<td align="center">0.153</td>
<td align="center">96.4</td>
<td align="center">399</td>
</tr>
</tbody>
</table>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
